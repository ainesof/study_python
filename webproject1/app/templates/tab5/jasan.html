<!DOCTYPE html>
<html lang="ko" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>출입증 현황</title>
    {% extends 'base.html' %}
    {% block content %}

<style>
</style>
<script>

var readmode='';

$(function () {

    readmode='{{readmode}}';
    $('#undo_exc').hide();

    <!-- 메뉴 링크 -->
    $('button[name^=submenu]').click(function(){
        var menu=$(this).attr('name')
        if(menu=='submenu1'){  window.open("/jasan/0", "_self");   }
        else if(menu=='submenu2'){ window.open("/jasan/1", "_self");  }
        else if(menu=='submenu3'){ window.open("/jasan/2", "_self");  }
    });

});

    <!-- 수정/저장 -->
function modify(){
   if(readmode=='y'){
        $.ajax({
            url : {{ url_for('tab5.jasan_modi')}}
            ,type: 'post'
            ,dataType: 'JSON'
            ,traditional : true
            ,data: {'readmode': readmode}
        })
        .done(function(value){
            readmode=value;
            var context="";
            $('[name="toExcel"]').hide();
            $('#undo_exc').show();
            $('#modi_exc').val("저장");

            context+='<table class="table table-striped table-bordered table-hover" id="tab5_table">';
            context+='<thead>';
            context+='<tr name="thead_tr" class="thead-dark">';
            {% for i in range(header|length) %}
                context+='<th style="font-size:10pt;">{{header[i]}}</th>';
            {% endfor %}
            context+='</tr></thead>';
            context+='<tbody id="tbody">';
            {% for i in range(queryData1|length) %}
                context+='<tr>';
                {% for j in range(header|length) %}
                    context+='<td style="font-size:10pt;">';
                    context+='<input type="text" style="width:100%; border:none; background:transparent;" value={{queryData1[i][j]}}';
                    {% if j==0 %}
                        context+=' disabled ';
                    {% endif %}
                    context+='></td>';
                {% endfor %}
                context+='</tr>';
            {% endfor %}
            context+='</tbody></table>';

            $('#table_readmode').empty();
            $('#table_readmode').html(context);
            $('[name="thead_tr"]').attr('align','center');

        });
    }
    else if(readmode=='n'){
        dataset=[];
        value='';
        maxCell={{(header|length)}}*{{(queryData1|length)}};
        <!-- td.eq(5).text(); 는 input으로 감싸지 않은 값 가져옴 -->
        var td=$('#tbody').children().children();
        for(var i=0;i<maxCell;i++){
            value=td.eq(i).children().val();
            dataset.push(value);
        }
        $.ajax({
            url : {{ url_for('tab5.jasan_modi')}}
            ,type: 'post'
            ,dataType: 'JSON'
            ,traditional : true
            ,data: {'readmode': readmode,'dataset': JSON.stringify(dataset)}
        });


    }
}

    <!-- 수정취소 -->
function cancel(){
    history.go(0);
}

</script>
</head>
<body>
<div class="container my-3">
    <table>
        <tr>
            <p class="text-center" style="font-size:20pt;"><b name="headtitle">{{headtitle}}</b></p>
        </tr>
        <div class="container my-3"><tr><td colspan="3">
            <div class="btn-group btn-group-sm" role="group" aria-label="...">
                <button type="button" name="submenu1" class="btn btn-outline-secondary">{{title[0]}}</button>
                <button type="button" name="submenu2" class="btn btn-outline-secondary">{{title[1]}}</button>
                <button type="button" name="submenu3" class="btn btn-outline-secondary">{{title[2]}}</button>
            </div>
        </td></tr></div>
        <tr style="height:30px"></tr>
        <tr>
            <div><td align="right" style="width:600px;">
                <input class="btn btn-dark" type="button" name="toExcel" value="excel"/>
                <input id="modi_exc" class="btn btn-dark" type="button" onclick="modify()" value="수정" style="display:inline"/>
                <input id="undo_exc" class="btn btn-dark" type="button" onclick="cancel()" value="취소">
            </td></div>
        </tr>
    </table>
</div>
<div id="table_readmode" class="container my-3">
    <table class="table table-striped table-bordered table-hover" id="tab5_table" style="">
        <thead>
            <tr class="thead-dark" align="center">
                {% for i in range(header|length) %}
                <th style="font-size:10pt;">{{header[i]}}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody align="center">
            {% for i in range(queryData1|length) %}
            <tr>
                {% for j in range(header|length) %}
                    <td style="font-size:10pt;">
                        {{queryData1[i][j]}}
                    </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<input type="hidden" name="win" value="{{win}}"/>
<input type="hidden" name="logic" value="{{logic}}"/>
{% endblock %}

</body>
</html>